#set( $ContextPath = ${request.contextPath} )
<html>
	<head>
		<title>校验码Demo - WebSocket/SockJS</title>
		<link type="text/css" href="${ContextPath}/resources/css/bootstrap.min.css" rel="stylesheet"/>
		<link type="text/css" href="${ContextPath}/resources/css/bootstrap-switch.min.css" rel="stylesheet"/>
		
		<script type="text/javascript" src="${ContextPath}/resources/sockjs-0.3.min.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/jquery-1.11.2.min.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/jquery.timers.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/jquery.cookie.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/notify.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/binary.min.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/stomp.js"></script>
		
		<script type="text/javascript" src="${ContextPath}/resources/bootstrap.js"></script>
		<script type="text/javascript" src="${ContextPath}/resources/bootstrap-switch.js"></script>
		
		<script type="text/javascript" src="${ContextPath}/resources/date.js"></script>
		
		<script type="text/javascript">
		
			function checkAll(){
				$('input[type=checkbox]').each(function(){
					$(this).prop("checked", true);
				});
			}
			
			function uncheckAll(){
				$('input[type=checkbox]').each(function(){
					$(this).prop("checked", false);
				});
			}
			
			function setParams(){
			
				var clients = new Array();
				$("input[type='checkbox']:checked").each(function(){
					clients.push($(this).val());
				});
				
				var data = {
					'clients': clients,
					'param'  : [
						'triggerF11=11:20:00,11:28:40',
						'triggerSetPolicy=11:25:00',
						'triggerLoadResource=11:18:00'
					]
				}
				
				$.ajax({
					url  : "batch/setParam",
					type : 'PUT',
					data : JSON.stringify(data),
					contentType: 'application/json; charset=utf-8',
					success: function(json) { 
						console.log("success");
					},
		            error: function(msg) {
		            }
				});
			}
		
			function triggerReload(){
			
				var clients = new Array();
				$("input[type='checkbox']:checked").each(function(){
					clients.push($(this).val());
				});
				
				$.ajax({
					url  : "batch/trigger/reload",
					type : 'PUT',
					data : JSON.stringify(clients),
					contentType: 'application/json; charset=utf-8',
					success: function(json) { 
						console.log("success");
					},
		            error: function(msg) {
		            }
				});
			}
			
			function triggerF11(){
			
				var clients = new Array();
				$("input[type='checkbox']:checked").each(function(){
					clients.push($(this).val());
				});
				
				$.ajax({
					url  : "batch/trigger/F11",
					type : 'PUT',
					data : JSON.stringify(clients),
					contentType: 'application/json; charset=utf-8',
					success: function(json) { 
						console.log("success");
					},
		            error: function(msg) {
		            }
				});
			}
			
			function message(message){
				
				var clients = new Array();
				$("input[type='checkbox']:checked").each(function(){
					clients.push($(this).val());
				});
				
				$.ajax({
					url  : "batch/message/" + message,
					type : 'PUT',
					data : JSON.stringify(clients),
					contentType: 'application/json; charset=utf-8',
					success: function(json) { 
						console.log("success");
					},
		            error: function(msg) {
		            }
				});
			}
		</script>
	</head>
	<body>
		<div class="panel panel-default">
			  <div class="panel-heading">
			  	<div class="row"><h5 class="panel-title">在线客户端</h5></div>
			  </div>
			  <div class="panel-body">
			  	<table class="table table-striped">
			  		<thead>
			  			<td>
			  				<input type="radio" name="sel" value="select" onclick="return checkAll();"/>全选
			  				<input type="radio" name="sel" value="deselect" onclick="return uncheckAll();"/>清除
			  			</td>
			  		</thead>
					<tbody>
					#foreach(${client} in ${CLIENTS})
					<tr>
						<td><input type="checkbox" value="${client}">${client}</td>
					</tr>
					#end
					</tbody>
					<thead>
			  			<td>
			  				<input type="radio" name="sel" value="select" onclick="return checkAll();"/>全选
			  				<input type="radio" name="sel" value="deselect" onclick="return uncheckAll();"/>清除
			  			</td>
			  		</thead>
				</table>
					<button style="btn btn-xs" onclick="return message('HELLO');">广播</button>
					<button style="btn btn-xs" onclick="return setParams();">定时器</button>
					
					<button style="btn btn-xs" onclick="return triggerReload();">重新加载配置</button>
					<button style="btn btn-xs" onclick="return triggerF11();">触发F11</button>
			  </div>
			  <div class="panel-footer" style="text-align:center;"><label id="TIMER">00:00:00.000</label></div>
			</div>
		</div>
	</body>
</html>